meta: {v: 1.0, created: 2025-12-16, purpose: identify available info per log source}

sources:
  desktop_app:
    loc: ~/Library/Logs/Claude/
    files:
      main.log: app lifecycle (startup, shutdown, extensions) - NOT chat switches
      mcp.log: "GOLD - every MCP tool call with full JSON (tool, args, results)"
      "mcp-server-{name}.log": per-server debug
    mcp_format: |
      timestamp [info] [server] {"method":"tools/call","params":{"name":"tool","arguments":{...}}}
    signals: [read_file, list_directory, start_search]

  cli:
    loc: ~/.claude/
    files:
      "debug/{sessionId}.txt": full transcripts, DEBUG output, tool calls
      history.jsonl: user prompts only
      daemon.log: pulse/orchestration heartbeats
      "logs/claude_*.log": command execution
      logs/orchestrator_pulse.log: orchestration events

  app_data:
    loc: ~/Library/Application Support/Claude/
    files:
      "Local Storage/leveldb/": chat fragments, UI state, session markers
      Session Storage/: session namespaces, chat UUIDs
    extraction: 'strings "Session Storage/000003.log" | grep -E uuid-pattern'

detection_matrix:
  file_read_desktop: {src: mcp.log, method: "parse JSON for read_file"}
  dir_listing: {src: mcp.log, method: "parse for list_directory"}
  any_tool_call: {src: mcp.log, method: extract tool+args}
  app_start: {src: main.log, method: grep startup patterns}
  cli_session: {src: ~/.claude/debug/, method: new file created}
  cli_tools: {src: "debug/*.txt", method: parse DEBUG lines}
  chat_uuid: {src: Session Storage, method: strings+grep}

cannot_detect: [chat_switch, response_content, footer_presence, context_compaction, chat_broken]

strategy:
  primary: mcp.log (all file reads, tool calls, timestamps, JSON=parseable)
  secondary: Session Storage LevelDB (chat UUIDs, activity indicator)
  tertiary: main.log (app lifecycle only)

parser_design:
  - tail mcp.log for new entries
  - parse JSON each line
  - extract timestamp, tool_name, arguments, result
  - emit structured events
  chat_detection: watch Session Storage or use "system_status.yml read" as positive signal
