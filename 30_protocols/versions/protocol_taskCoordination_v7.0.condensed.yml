meta: {v: 8.0, date: 2025-12-14, status: active, supersedes: v7.0}

changes_from_v7:
  response_file_types:
    "{task}.$$.response.md": milestone/interim, worker hits checkpoint
    "{task}.$$.completion.md": final completion, task fully done
  subtask_nesting: "{parentTaskNum}_{nn}.{slug}.md"
  claim_format: PID ($$) added to filename, task dir moved to in_progress/

dir_structure:
  staged/: pre-pipeline holding
  to_execute/: ready for claiming
  in_progress/: active work, claim via {taskId}.{slug}{.pid}.md
  completed/: finished work
  error/: failed tasks with error reports

lifecycle:
  flow: staged → to_execute → in_progress → completed|error
  claim: |
    mv "${TASK}.md" "${TASK}.${PID}.md"
    mv to in_progress/
  complete: |
    create "${TASK}.$$.completion.md"
    mv to completed/ (strip claim prefix)
  milestone: create "${TASK}.$$.response.md" (stays in_progress)

orchestration:
  hierarchy: Desktop → claude_cli → codex_cli (nested subtasks)
  orchestrator_duties: [decompose, distribute, monitor, coordinate, aggregate, complete]
  worker_duties: [claim, execute, report milestones, complete, notify]
  delegation_flow:
    1: orchestrator creates task in to_execute/
    2: worker claims, moves to in_progress/
    3: worker reports .response.md milestones
    4: orchestrator may prompt continuation
    5: worker creates .completion.md, moves to completed/
    6: orchestrator creates symlink to child

files:
  task: {required: [title, type, priority, posted, description, expected_response], optional: [target_worker, session, entry_criteria, exit_criteria, subtasks]}
  response: {fields: [milestone, status, summary, needs, timestamp], status_values: [awaiting_input, blocked, continuing]}
  completion: {fields: [completed, status, summary, artifacts], status_values: [success, partial, failed]}

related: [spec_task_id_counter, cli_session_persistence, cli_orchestration]

versions: [{v: 8.0, date: 2025-12-14}, {v: 7.0, date: 2025-12-13}, {v: 6.0, date: 2025-12-11}, {v: 5.0, date: 2025-11-23}]
