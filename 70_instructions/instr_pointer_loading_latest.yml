---
metadata:
  title: Reference Pointer Loading Instructions
  version: 1.0.0
  created: 2025-12-05
  maintainer: PianoMan
  target: Any
  status: active
  related:
    protocol: ../../30_protocols/protocol_reference_pointers_latest.yml
    schema: ../../50_schemas/schema_pointer_syntax_latest.yml

recognition:
  pattern: |
    Memory slots matching format: <TYPE>:<PATH_OR_QUERY> [| <KEY>:<VALUE>]*
    
  types_to_recognize:
    - STARTER, PROJECT, PREFS, CONTEXT, TOOL, REF  # PATH-based
    - QUERY  # Search-based
    - RECENT  # Category-based
    
  action: "Parse each pointer, categorize by type and load behavior"

load_sequence:
  1_conversation_start:
    condition: "PRIORITY:1 AND LOAD:AUTO"
    action: "Load via Desktop Commander immediately"
    silent: true
    max_files: 5
    rationale: "Don't announce loading - just have the context ready"
    
  2_topic_triggered:
    condition: "PRIORITY:2 AND LOAD:TOPIC AND topic_matches"
    action: "Load when conversation enters relevant domain"
    announce: "optional, brief if at all"
    matching: "Use tags field in destination file for topic matching"
    
  3_on_demand:
    condition: "PRIORITY:3 OR LOAD:DEMAND"
    action: "Load only when explicitly needed"
    announce: "yes - explain why loading"
    example: "Let me check the coordination protocol spec..."

execution_methods:
  PATH_pointers:
    tool: Desktop Commander read_file
    path_base: "~/Documents/AI/ai_root/"
    example: |
      view ai_memories/60_knowledge/about_user/identity.yml
      
  QUERY_pointers:
    tool: memory_search (when available) or Desktop Commander start_search
    fallback: "ripgrep-based search of ai_memories/"
    example: |
      start_search path=ai_memories pattern="CLI timeout" searchType=content
      
  RECENT_pointers:
    tool: Desktop Commander list_directory + read_file
    method: "List category directory, sort by date, read top N"
    categories:
      session_summaries: ai_claude/work/session_summaries/
      task_completions: ai_comms/claude_cli/completed/
      decisions: ai_memories/60_decisions/

pointer_chaining:
  when: "Destination file contains 'pointers' section"
  behavior: |
    Treat nested pointers same as memory slot pointers.
    Follow based on rel type and load hint.
    
  depth_limit: 3
  
  circular_prevention: |
    Track loaded paths in working memory during session.
    Skip already-loaded files.
    Warn if circular reference detected.

context_conservation:
  principle: "Load what's needed, not everything available"
  
  max_auto_load: 5  # Files at conversation start
  
  prefer_summaries: |
    Use header.summary when full content not needed.
    Load full content only when detail required.
    
  token_awareness: |
    Each loaded file consumes context.
    Prefer small, focused destination files.
    Large files should use PRIORITY:3 / LOAD:DEMAND.

error_handling:
  file_not_found:
    action: "Note in thinking, continue without"
    announce: false
    
  parse_error:
    action: "Log issue, skip file, suggest user review"
    announce: "briefly if relevant"
    
  search_no_results:
    action: "Note no matches found, continue"
    announce: "only if user explicitly asked for information"

integration_with_existing_behavior:
  native_memory_content:
    status: "Coexists during transition"
    priority: "Pointers take precedence over raw content"
    migration: "Gradually replace content with pointers"
    
  project_files:
    status: "Separate system - still loads normally"
    relationship: "Pointers can reference project file locations"
    
  user_preferences:
    status: "Separate system - handled by Anthropic"
    relationship: "Pointers supplement with deeper context"

practical_examples:
  conversation_start_flow: |
    1. Receive memory slots including:
       "STARTER:ai_memories/60_knowledge/about_user/identity.yml | PRIORITY:1 | LOAD:AUTO"
       "PROJECT:ai_claude/work/current_focus.yml | PRIORITY:1 | LOAD:AUTO"
       "REF:ai_general/docs/40_specs/cli_coordination.yml | PRIORITY:3 | LOAD:DEMAND"
    
    2. Immediately load identity.yml and current_focus.yml (silent)
    
    3. Now know: User is PianoMan, 25+ year dev, working on memory system restructure
    
    4. REF pointer noted but not loaded until CLI coordination discussed
    
  topic_triggered_flow: |
    1. User says: "Let's work on the chat orchestrator"
    
    2. Detect topic matches PROJECT pointer tags
    
    3. Load: "PROJECT:ai_claude/work/orchestrator_state.yml | LOAD:TOPIC"
    
    4. Now have current orchestrator status, recent issues, next steps
    
  on_demand_flow: |
    1. User asks: "What's the exact format for CLI task files?"
    
    2. Recognize need for spec detail
    
    3. Announce: "Let me check the coordination protocol spec..."
    
    4. Load: "REF:ai_general/docs/40_specs/cli_coordination.yml"
    
    5. Provide specific answer from loaded content

do_not:
  - Load all pointers at once
  - Announce every file load
  - Follow pointer chains deeper than 3 levels
  - Re-load already loaded files in same session
  - Guess at file contents if load fails
