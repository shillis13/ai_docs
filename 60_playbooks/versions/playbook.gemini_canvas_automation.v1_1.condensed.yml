meta: {v: 1.1.0, created: 2025-12-19, author: PianoMan+Claude, status: validated, tags: [gemini, canvas, automation, browser, artifacts]}

summary: End-to-end Gemini Canvas automation - new chat → enable Canvas → upload → prompt → download artifacts

note: Canvas uses Monaco editor (VS Code) not HTML5 canvas. Artifacts appear as "Open" buttons.

prerequisites:
  browser: [Chrome with Gemini session, "Allow JavaScript from Apple Events", Gemini tab active]
  tools: ["cliclick: brew install cliclick", Desktop Commander MCP]
  scripts:
    gemini_chat/: [gemini_download_canvas_filtered.js, gemini_list_files.js]
    applescript/: [gemini_canvas_enable.scpt, gemini_file_upload.scpt, gemini_drag_drop_upload.scpt]

steps:
  1_navigate: |
    osascript -e 'tell application "Google Chrome" to set URL of active tab... "https://gemini.google.com/app"'
    wait 2s
  2_enable_canvas: |
    osascript ~/bin/applescript/gemini_canvas_enable.scpt
    (Tab×4 to reach Canvas in Tools menu, focus on input first)
  3_upload: |
    osascript gemini_file_upload.scpt "/path/file.pdf"  # file picker
    osascript gemini_drag_drop_upload.scpt "/path/file.pdf"  # drag-drop
    wait 2-5s
  4_prompt: |
    keystroke "prompt text" then keystroke return
    wait 5-15s
  5_download: |
    window.GEMINI_CANVAS_CONFIG = { extFilter: '.py' };
    // execute gemini_download_canvas_filtered.js
    // check window.GEMINI_CANVAS_RESULTS

filter_options:
  extFilter: {type: "string|array", ex: '".py" or [".py",".js"]', desc: by extension}
  nameFilter: {type: string, ex: '"fibonacci"', desc: partial match title/code}
  newest: {type: int, desc: only N most recent}
  oldest: {type: int, desc: only N oldest}
  dryRun: {type: bool, desc: list without download}
  delayMs: {type: int, default: 800, desc: ms between artifacts}

issues:
  canvas_not_enabling: [wrong tab count, focus not on input, timing]
  no_artifacts: [canvas not enabled, code inline instead, still generating]
  wrong_extension: [detection missed, use nameFilter, download all then rename]

canvas_vs_inline:
  canvas: {appear: "Open button + Monaco panel", script: gemini_download_canvas_filtered.js, when: multi-file/complex}
  inline: {appear: code block in chat, script: gemini_download_filtered.js, when: simple snippets}

related: [gemini_chat/README.md, playbook.cli_browser_automation_guide.latest.md]
